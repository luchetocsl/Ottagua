---
import type { CollectionEntry } from 'astro:content';

interface Props {
  currentSlug: string;
  posts: CollectionEntry<'blog'>[];
}

const { currentSlug, posts } = Astro.props;

// Sort posts by publication date (newest first)
const sortedPosts = [...posts].sort((a, b) => 
  new Date(b.data.pubDate).getTime() - new Date(a.data.pubDate).getTime()
);

// Find the index of the current post
const currentIndex = sortedPosts.findIndex(post => post.slug === currentSlug);

// Get previous and next posts
const prevPost = currentIndex < sortedPosts.length - 1 ? sortedPosts[currentIndex + 1] : null;
const nextPost = currentIndex > 0 ? sortedPosts[currentIndex - 1] : null;
---

<div class="my-4 pt-2 mx-auto max-w-[1240px] px-4">
  <div class="flex justify-between items-end">
    {prevPost && (
      <a href={`/blog/${prevPost.slug}/`} class="flex items-center no-underline py-0.5 max-w-[35%] hover:text-red-accent">
        <div class="text-xs text-red mx-1">←</div>
        <div class="flex-1 text-left">
          <div class="text-red-accent text-[10px] mb-0.5">Artículo anterior</div>
          <div class="text-red text-xs font-normal leading-tight">{prevPost.data.title}</div>
        </div>
      </a>
    )}
    
    {!prevPost && <div class="w-[35%]"></div>}
    
    <a href="/blog/" class="flex justify-center items-end no-underline pb-0.5 w-1/6 hover:text-red-accent">
      <div class="text-red font-normal text-[10px]">Volver al blog</div>
    </a>
    
    {nextPost && (
      <a href={`/blog/${nextPost.slug}/`} class="flex items-center no-underline py-0.5 max-w-[35%] hover:text-red-accent">
        <div class="flex-1 text-right">
          <div class="text-red-accent text-[10px] mb-0.5">Artículo siguiente</div>
          <div class="text-red text-xs font-normal leading-tight">{nextPost.data.title}</div>
        </div>
        <div class="text-xs text-red mx-1">→</div>
      </a>
    )}
    
    {!nextPost && <div class="w-[35%]"></div>}
  </div>
</div>

<style>
  /* All styling now handled by Tailwind classes */
  @media (max-width: 768px) {
    div[class*="flex justify-between"] {
      @apply flex-col gap-3;
    }

    a[class*="max-w-[35%]"], div[class*="w-[40%]"] {
      @apply max-w-full;
    }

    a[class*="w-1/5"] {
      @apply w-full my-3 justify-center;
    }

    div[class*="text-right"] {
      @apply text-left;
    }

    a[class*="flex items-center"]:last-child {
      @apply flex-row-reverse;
    }
    
    div[class*="text-sm font-normal"] {
      @apply text-xs;
    }
  }
</style>
