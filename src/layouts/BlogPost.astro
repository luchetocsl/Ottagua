---
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import FormattedDate from "../components/FormattedDate.astro";
import BaseLayout from "./BaseLayout.astro";
import BlogNavigation from "../components/BlogNavigation.astro";

type Props = CollectionEntry<"blog">["data"] & {
	currentSlug?: string;
	allPosts?: CollectionEntry<"blog">[];
};

const {
	title,
	description,
	summary,
	pubDate,
	updatedDate,
	heroImage,
	tags,
	currentSlug,
	allPosts,
} = Astro.props;
---

<BaseLayout>
	<main class='w-full'>
		<!-- Full-width hero image container -->
		<div class='overflow-hidden mb-8 w-full max-w-full'>
			<div class='max-w-[1240px] mx-auto px-4 flex justify-center'>
				{
					heroImage && (
						<Image
							width={1800}
							height={500}
							src={heroImage}
							alt={title}
							class='rounded-lg w-full aspect-[21/9] object-cover object-center mb-8'
						/>
					)
				}
			</div>
		</div>

		<!-- Content container with 1240px max width -->
		<div class='max-w-[1240px] mx-auto px-4'>
			<article class='mx-auto max-w-prose leading-7 text-black'>
				<div class='flex flex-col items-start mb-8'>
					<h1
						class='mb-4 text-4xl font-bold leading-tight text-black'>
						{title}
					</h1>
					<div class='text-left'>
						<FormattedDate
							date={pubDate}
							class='text-black no-underline'
						/>
						{
							updatedDate && (
								<div class='mt-1 text-sm'>
									Last updated on{" "}
									<FormattedDate
										date={updatedDate}
										class='text-black no-underline'
									/>
								</div>
							)
						}
					</div>
					{
						tags?.length ? (
							<div class='mt-3 flex flex-wrap gap-2'>
								{tags.map((tag) => (
									<span class='px-3 py-1 text-xs font-medium text-black rounded-full border border-black/15 bg-cream/60'>
										{tag}
									</span>
								))}
							</div>
						) : null
					}
					<p
						class='mt-4 leading-relaxed text-black opacity-80 text-md'>
						{summary ?? description}
					</p>
				</div>

				<div class='text-black prose'>
					<slot />
				</div>
			</article>

			{
				currentSlug && allPosts && (
					<BlogNavigation
						currentSlug={currentSlug}
						posts={allPosts}
					/>
				)
			}
		</div>
	</main>
</BaseLayout>

<!-- All styling now handled by Tailwind Typography plugin modifiers in the markup -->

<style is:global>
	/* Blogpost-specific styles for Markdown/MDX content */

	.prose {
		/* Tailwind Typography plugin color overrides */
		--tw-prose-body: #000 !important;
		--tw-prose-headings: #000 !important;
		--tw-prose-links: var(--red, #f80b01) !important;
		--tw-prose-bold: #000 !important;
		--tw-prose-counters: #000 !important;
		--tw-prose-bullets: #000 !important;
		--tw-prose-hr: #000 !important;
		--tw-prose-quotes: var(--red-accent, #f85c4d) !important;
		--tw-prose-quote-borders: var(--red-accent, #f85c4d) !important;
		--tw-prose-captions: #000 !important;
		--tw-prose-code: #000 !important;
		--tw-prose-pre-code: #000 !important;
		--tw-prose-pre-bg: var(--cream, #f1f5e7) !important;
		--tw-prose-th-borders: var(--red, #f80b01) !important;
		--tw-prose-td-borders: var(--red, #f80b01) !important;
		color: #000 !important;
	}

	.prose p,
	.prose li,
	.prose ol,
	.prose ul,
	.prose strong,
	.prose em,
	.prose code {
		color: #000 !important;
	}

	.prose ul > li::marker,
	.prose ol > li::marker {
		color: #000 !important;
	}

	.prose h1,
	.prose h2,
	.prose h3,
	.prose h4,
	.prose h5,
	.prose h6 {
		font-family: "Geist Sans", sans-serif;
		color: #000 !important;
		margin-top: 3rem;
		margin-bottom: 1rem;
		font-weight: 700;
	}

	.prose p,
	.prose li {
		font-family: "Inter Variable", sans-serif;
		color: #000 !important;
		font-size: 1rem;
		line-height: 1.5;
		margin-bottom: 1.5em;
	}

	.prose ol,
	.prose ul {
		font-family: "Inter Variable", sans-serif;
		color: #000 !important;
		font-size: 1rem;
		line-height: 1.5;
		margin-bottom: 1.5em;
	}

	.prose a {
		color: var(--red, #f80b01);
		text-decoration: underline;
		text-underline-offset: 4px;
		text-decoration-thickness: 2px;
	}

	.prose blockquote {
		background: rgba(248, 92, 77, 0.07);
		border-left: 4px solid var(--red-accent, #f85c4d);
		padding: 1.5em 2em;
		margin: 2em 0;
		border-radius: var(--radius-md, 1rem);
	}

	.prose ul,
	.prose ol {
		margin-bottom: 1.5em;
		padding-left: 2em;
		line-height: 1.7;
	}

	.prose hr {
		border: none;
		border-top: 2px solid var(--red, #f80b01);
		margin: 2.5em 0;
	}

	/* Add more blog-specific styles as needed */
</style>
